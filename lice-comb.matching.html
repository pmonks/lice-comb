<!DOCTYPE html PUBLIC ""
    "">

<html><head><meta charset="UTF-8" /><title>lice-comb.matching documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name"></span> <span class="project-version"></span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lice-comb</span></div></div></li><li class="depth-2 branch"><a href="lice-comb.deps.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>deps</span></div></a></li><li class="depth-2 branch"><a href="lice-comb.files.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>files</span></div></a></li><li class="depth-2 branch"><a href="lice-comb.lein.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lein</span></div></a></li><li class="depth-2 branch current"><a href="lice-comb.matching.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>matching</span></div></a></li><li class="depth-2 branch"><a href="lice-comb.maven.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>maven</span></div></a></li><li class="depth-2"><a href="lice-comb.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="lice-comb.matching.html#var-id-.3Ename"><div class="inner"><span>id-&gt;name</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-init.21"><div class="inner"><span>init!</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-lice-comb-license-ref.3F"><div class="inner"><span>lice-comb-license-ref?</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-name-.3Eexpressions"><div class="inner"><span>name-&gt;expressions</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-name-.3Eexpressions-info"><div class="inner"><span>name-&gt;expressions-info</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-proprietary-commercial.3F"><div class="inner"><span>proprietary-commercial?</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-public-domain.3F"><div class="inner"><span>public-domain?</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-text-.3Eexpressions"><div class="inner"><span>text-&gt;expressions</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-text-.3Eexpressions-info"><div class="inner"><span>text-&gt;expressions-info</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-unidentified-.3Ename"><div class="inner"><span>unidentified-&gt;name</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-unidentified.3F"><div class="inner"><span>unidentified?</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-uri-.3Eexpressions"><div class="inner"><span>uri-&gt;expressions</span></div></a></li><li class="depth-1"><a href="lice-comb.matching.html#var-uri-.3Eexpressions-info"><div class="inner"><span>uri-&gt;expressions-info</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">lice-comb.matching</h1><div class="doc"><pre class="plaintext">The core matching functionality within lice-comb. Matching is provided for
three categories of input, and uses a different process for each:
1. License names
2. License uris
3. License texts

Each matching fn has two variants:
1. A 'simple' version that returns a set of SPDX expressions (Strings)
2. An 'info' version that returns an 'expressions-info map'

An expressions-info map has this structure:
* key:   an SPDX expression (String), which may be a single SPDX license
         identifier
* value: a sequence of 'expression-info' maps

Each lice-comb expression-info map has this structure:
* :id (String, optional):
  The SPDX identifier within the expression that this info map refers to.
* :type (either :declared or :concluded, mandatory):
  Whether this identifier was unambiguously declared within the input or
  was instead concluded by lice-comb (see SPDX specification for more detail
  on the definition of these two terms).
* :confidence (one of: :high, :medium, :low, only provided when :type = :concluded):
  Indicates the approximate confidence lice-comb has in its conclusions for
  this particular SPDX identifier.
* :strategy (a keyword, mandatory):
  The strategy lice-comb used to determine this particular SPDX identifier.
  See the source for lice-comb.utils for an up-to-date list of all possible
  values.
* :source (a sequence of Strings):
  The list of sources used to arrive at this SPDX identifier, starting from
  the most general (the input) to the most specific (the smallest subset of
  the input that was used to make this determination).</pre></div><div class="public anchor" id="var-id-.3Ename"><h3>id-&gt;name</h3><div class="usage"><code>(id-&gt;name id)</code></div><div class="doc"><pre class="plaintext">Returns the human readable name of the given license or exception identifier;
either the official SPDX license or exception name or, if the id is a
lice-comb specific LicenseRef, a lice-comb specific name. Returns the id
verbatim if unable to determine a name. Returns nil if the id is blank.</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L87">view source</a></div></div><div class="public anchor" id="var-init.21"><h3>init!</h3><div class="usage"><code>(init!)</code></div><div class="doc"><pre class="plaintext">Initialises this namespace upon first call (and does nothing on subsequent
calls), returning nil. Consumers of this namespace are not required to call
this fn, as initialisation will occur implicitly anyway; it is provided to
allow explicit control of the cost of initialisation to callers who need it.

Note: this method has a substantial performance cost.</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L214">view source</a></div></div><div class="public anchor" id="var-lice-comb-license-ref.3F"><h3>lice-comb-license-ref?</h3><div class="usage"><code>(lice-comb-license-ref? id)</code></div><div class="doc"><pre class="plaintext">Is the given id one of lice-comb's custom LicenseRefs?
</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L61">view source</a></div></div><div class="public anchor" id="var-name-.3Eexpressions"><h3>name-&gt;expressions</h3><div class="usage"><code>(name-&gt;expressions name)</code></div><div class="doc"><pre class="plaintext">Attempts to determine the SPDX license expression(s) (a set of Strings) from
the given 'license name' (a String), or nil if there aren't any.  This involves:
1. Determining whether the name is a valid SPDX license expression, and if so
   normalising (see clj-spdx's spdx.expressions/normalise fn) and returning it
2. Checking if the name is actually a URI, and if so performing URL matching
   on it (as per url-&gt;expressions)
3. attempting to construct one or more SPDX license expressions from the
   name</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L200">view source</a></div></div><div class="public anchor" id="var-name-.3Eexpressions-info"><h3>name-&gt;expressions-info</h3><div class="usage"><code>(name-&gt;expressions-info name)</code></div><div class="doc"><pre class="plaintext">Returns a lice-comb expressions-info map for the given 'license name' (a
String), or nil if there isn't one.  This involves:
1. Determining whether the name is a valid SPDX license expression, and if so
   normalising it (see clj-spdx's spdx.expressions/normalise fn)
2. Checking if the name is actually a URI, and if so performing URL matching
   on it (as per url-&gt;expressions-info)
3. attempting to construct one or more SPDX license expressions from the
   name

The keys in the maps are the detected SPDX license and exception identifiers,
and each value contains information about how that identifiers was determined.</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L174">view source</a></div></div><div class="public anchor" id="var-proprietary-commercial.3F"><h3>proprietary-commercial?</h3><div class="usage"><code>(proprietary-commercial? id)</code></div><div class="doc"><pre class="plaintext">Is the given id lice-comb's custom 'proprietary / commercial' LicenseRef?
</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L71">view source</a></div></div><div class="public anchor" id="var-public-domain.3F"><h3>public-domain?</h3><div class="usage"><code>(public-domain? id)</code></div><div class="doc"><pre class="plaintext">Is the given id lice-comb's custom 'public domain' LicenseRef?
</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L66">view source</a></div></div><div class="public anchor" id="var-text-.3Eexpressions"><h3>text-&gt;expressions</h3><div class="usage"><code>(text-&gt;expressions text)</code></div><div class="doc"><pre class="plaintext">Returns a set of SPDX expressions (Strings) for the given license text (a
String, Reader, InputStream, or something that is accepted by
clojure.java.io/reader - File, URL, URI, Socket, etc.), or nil if no
expressions were found.

Notes:
* this function implements the SPDX matching guidelines (via clj-spdx).
  See <a href="https://spdx.github.io/spdx-spec/v2.3/license-matching-guidelines-and-templates/">https://spdx.github.io/spdx-spec/v2.3/license-matching-guidelines-and-templates/</a>
* the caller is expected to open &amp; close a Reader or InputStream passed to
  this function (e.g. using clojure.core/with-open)
* you cannot pass a String representation of a filename to this method - you
  should pass filenames through clojure.java.io/file (or similar) first</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L116">view source</a></div></div><div class="public anchor" id="var-text-.3Eexpressions-info"><h3>text-&gt;expressions-info</h3><div class="usage"><code>(text-&gt;expressions-info text)</code></div><div class="doc"><pre class="plaintext">Returns an expressions-info map for the given license text (a String, Reader,
InputStream, or something that is accepted by clojure.java.io/reader - File,
URL, URI, Socket, etc.), or nil if no expressions were found.

Notes:
* this function implements the SPDX matching guidelines (via clj-spdx).
  See <a href="https://spdx.github.io/spdx-spec/v2.3/license-matching-guidelines-and-templates/">https://spdx.github.io/spdx-spec/v2.3/license-matching-guidelines-and-templates/</a>
* the caller is expected to open &amp; close a Reader or InputStream passed to
  this function (e.g. using clojure.core/with-open)
* you cannot pass a String representation of a filename to this method - you
  should pass filenames through clojure.java.io/file (or similar) first</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L101">view source</a></div></div><div class="public anchor" id="var-unidentified-.3Ename"><h3>unidentified-&gt;name</h3><div class="usage"><code>(unidentified-&gt;name id)</code></div><div class="doc"><pre class="plaintext">Get the original name of the given unidentified license. Returns nil if id is nil
or is not a lice-comb unidentified LicenseRef.</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L81">view source</a></div></div><div class="public anchor" id="var-unidentified.3F"><h3>unidentified?</h3><div class="usage"><code>(unidentified? id)</code></div><div class="doc"><pre class="plaintext">Is the given id a lice-comb custom 'unidentified' LicenseRef?
</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L76">view source</a></div></div><div class="public anchor" id="var-uri-.3Eexpressions"><h3>uri-&gt;expressions</h3><div class="usage"><code>(uri-&gt;expressions uri)</code></div><div class="doc"><pre class="plaintext">Returns the SPDX license and/or exception identifiers (a set of Strings) for
the given uri, or nil if there aren't any.  It does this via two steps:
1. Seeing if the given URI is in the license or exception list, and returning
   the ids of the associated licenses and/or exceptions if so
2. Attempting to retrieve the plain text content of the given URI and
   performing full SPDX license matching on the result if there was one

Notes on step 1:
1. this does not perform exact matching; rather it simplifies URIs in various
   ways to avoid irrelevant differences, including performing a
   case-insensitive comparison, ignoring protocol differences (http vs https),
   ignoring extensions representing MIME types (.txt vs .html, etc.), etc.
   See lice-comb.impl.utils/simplify-uri for exact details.
2. URIs in the SPDX license and exception lists are not unique - the same URI
   may represent multiple licenses and/or exceptions.</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L153">view source</a></div></div><div class="public anchor" id="var-uri-.3Eexpressions-info"><h3>uri-&gt;expressions-info</h3><div class="usage"><code>(uri-&gt;expressions-info uri)</code></div><div class="doc"><pre class="plaintext">Returns an exceptions-info map for the given license uri (a String, URL, or
URI), or nil if no expressions were found.  It does this via two steps:
1. Seeing if the given URI is in the SPDX license or exception lists, and
   returning the ids of the associated licenses and/or exceptions if so
2. Attempting to retrieve the plain text content of the given URI and
   performing full SPDX license matching on the result if there was one

Notes on step 1:
1. this does not perform exact matching; rather it simplifies URIs in various
   ways to avoid irrelevant differences, including performing a
   case-insensitive comparison, ignoring protocol differences (http vs https),
   ignoring extensions representing MIME types (.txt vs .html, etc.), etc.
   See lice-comb.impl.utils/simplify-uri for exact details.
2. URIs in the SPDX license and exception lists are not unique - the same URI
   may represent multiple licenses and/or exceptions.</pre></div><div class="src-link"><a href="https://github.com/pmonks/lice-comb/blob/main/src/lice_comb/matching.clj#L134">view source</a></div></div></div></body></html>